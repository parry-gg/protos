// Event export tracking for self-service bracket exports to braacket.com.
syntax = "proto3";

option java_multiple_files = true;
option java_package = "gg.parry.grpc.models";

package parrygg.models;

// EventExportStatus represents the lifecycle state of an event export.
enum EventExportStatus {
  // Status not specified (invalid state).
  EVENT_EXPORT_STATUS_UNSPECIFIED = 0;
  // Export has been queued but processing hasn't started.
  EVENT_EXPORT_STATUS_PENDING = 1;
  // Export is currently being processed.
  EVENT_EXPORT_STATUS_IN_PROGRESS = 2;
  // Export completed successfully.
  EVENT_EXPORT_STATUS_SUCCESS = 3;
  // Export failed after all retry attempts.
  EVENT_EXPORT_STATUS_FAILED = 4;
}

// EventExport tracks the status and results of an event export to braacket.com.
// Each event can have at most one active export record.
message EventExport {
  // Unique identifier for this export record (UUID v7).
  string id = 1;
  // Event ID being exported.
  string event_id = 2;
  // Status of the export.
  EventExportStatus status = 3;
  // URL to the bracket on braacket.com (only set if status is SUCCESS).
  string braacket_url = 4;
  // Number of retries attempted so far.
  int32 retry_count = 5;
  // Error message from the last failed attempt (only set if status is FAILED).
  string last_error = 6;
  // ISO-8601 timestamp of when the export was created.
  string created_at = 7;
  // ISO-8601 timestamp of when the export was last updated.
  string updated_at = 8;
}
